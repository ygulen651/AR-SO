{"version":3,"file":"index.es.js","sources":["../src/utils/dom.ts","../src/utils/environment.ts","../../../../../../.yarn/berry/cache/@babel-runtime-npm-7.23.2-d013d6cf7e-10.zip/node_modules/@babel/runtime/helpers/esm/typeof.js","../../../../../../.yarn/berry/cache/@babel-runtime-npm-7.23.2-d013d6cf7e-10.zip/node_modules/@babel/runtime/helpers/esm/toPrimitive.js","../../../../../../.yarn/berry/cache/@babel-runtime-npm-7.23.2-d013d6cf7e-10.zip/node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","../../../../../../.yarn/berry/cache/@babel-runtime-npm-7.23.2-d013d6cf7e-10.zip/node_modules/@babel/runtime/helpers/esm/defineProperty.js","../src/utils/key.ts","../src/utils/weak-maps.ts","../src/plugin/dom-editor.ts","../src/utils/diff-text.ts","../src/utils/lines.ts","../src/plugin/with-dom.ts","../src/utils/constants.ts","../src/utils/hotkeys.ts","../../../../../../.yarn/berry/cache/@babel-runtime-npm-7.23.2-d013d6cf7e-10.zip/node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js","../../../../../../.yarn/berry/cache/@babel-runtime-npm-7.23.2-d013d6cf7e-10.zip/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js","../src/utils/range-list.ts"],"sourcesContent":["/**\n * Types.\n */\n\n// COMPAT: This is required to prevent TypeScript aliases from doing some very\n// weird things for Slate's types with the same name as globals. (2019/11/27)\n// https://github.com/microsoft/TypeScript/issues/35002\nimport DOMNode = globalThis.Node\nimport DOMComment = globalThis.Comment\nimport DOMElement = globalThis.Element\nimport DOMText = globalThis.Text\nimport DOMRange = globalThis.Range\nimport DOMSelection = globalThis.Selection\nimport DOMStaticRange = globalThis.StaticRange\nimport { DOMEditor } from '../plugin/dom-editor'\n\nexport {\n  DOMNode,\n  DOMComment,\n  DOMElement,\n  DOMText,\n  DOMRange,\n  DOMSelection,\n  DOMStaticRange,\n}\n\ndeclare global {\n  interface Window {\n    Selection: (typeof Selection)['constructor']\n    DataTransfer: (typeof DataTransfer)['constructor']\n    Node: (typeof Node)['constructor']\n  }\n}\n\nexport type DOMPoint = [Node, number]\n\n/**\n * Returns the host window of a DOM node\n */\n\nexport const getDefaultView = (value: any): Window | null => {\n  return (\n    (value && value.ownerDocument && value.ownerDocument.defaultView) || null\n  )\n}\n\n/**\n * Check if a DOM node is a comment node.\n */\n\nexport const isDOMComment = (value: any): value is DOMComment => {\n  return isDOMNode(value) && value.nodeType === 8\n}\n\n/**\n * Check if a DOM node is an element node.\n */\n\nexport const isDOMElement = (value: any): value is DOMElement => {\n  return isDOMNode(value) && value.nodeType === 1\n}\n\n/**\n * Check if a value is a DOM node.\n */\n\nexport const isDOMNode = (value: any): value is DOMNode => {\n  const window = getDefaultView(value)\n  return !!window && value instanceof window.Node\n}\n\n/**\n * Check if a value is a DOM selection.\n */\n\nexport const isDOMSelection = (value: any): value is DOMSelection => {\n  const window = value && value.anchorNode && getDefaultView(value.anchorNode)\n  return !!window && value instanceof window.Selection\n}\n\n/**\n * Check if a DOM node is an element node.\n */\n\nexport const isDOMText = (value: any): value is DOMText => {\n  return isDOMNode(value) && value.nodeType === 3\n}\n\n/**\n * Checks whether a paste event is a plaintext-only event.\n */\n\nexport const isPlainTextOnlyPaste = (event: ClipboardEvent) => {\n  return (\n    event.clipboardData &&\n    event.clipboardData.getData('text/plain') !== '' &&\n    event.clipboardData.types.length === 1\n  )\n}\n\n/**\n * Normalize a DOM point so that it always refers to a text node.\n */\n\nexport const normalizeDOMPoint = (domPoint: DOMPoint): DOMPoint => {\n  let [node, offset] = domPoint\n\n  // If it's an element node, its offset refers to the index of its children\n  // including comment nodes, so try to find the right text child node.\n  if (isDOMElement(node) && node.childNodes.length) {\n    let isLast = offset === node.childNodes.length\n    let index = isLast ? offset - 1 : offset\n    ;[node, index] = getEditableChildAndIndex(\n      node,\n      index,\n      isLast ? 'backward' : 'forward'\n    )\n    // If the editable child found is in front of input offset, we instead seek to its end\n    isLast = index < offset\n\n    // If the node has children, traverse until we have a leaf node. Leaf nodes\n    // can be either text nodes, or other void DOM nodes.\n    while (isDOMElement(node) && node.childNodes.length) {\n      const i = isLast ? node.childNodes.length - 1 : 0\n      node = getEditableChild(node, i, isLast ? 'backward' : 'forward')\n    }\n\n    // Determine the new offset inside the text node.\n    offset = isLast && node.textContent != null ? node.textContent.length : 0\n  }\n\n  // Return the node and offset.\n  return [node, offset]\n}\n\n/**\n * Determines whether the active element is nested within a shadowRoot\n */\n\nexport const hasShadowRoot = (node: Node | null) => {\n  let parent = node && node.parentNode\n  while (parent) {\n    if (parent.toString() === '[object ShadowRoot]') {\n      return true\n    }\n    parent = parent.parentNode\n  }\n  return false\n}\n\n/**\n * Get the nearest editable child and index at `index` in a `parent`, preferring\n * `direction`.\n */\n\nexport const getEditableChildAndIndex = (\n  parent: DOMElement,\n  index: number,\n  direction: 'forward' | 'backward'\n): [DOMNode, number] => {\n  const { childNodes } = parent\n  let child = childNodes[index]\n  let i = index\n  let triedForward = false\n  let triedBackward = false\n\n  // While the child is a comment node, or an element node with no children,\n  // keep iterating to find a sibling non-void, non-comment node.\n  while (\n    isDOMComment(child) ||\n    (isDOMElement(child) && child.childNodes.length === 0) ||\n    (isDOMElement(child) && child.getAttribute('contenteditable') === 'false')\n  ) {\n    if (triedForward && triedBackward) {\n      break\n    }\n\n    if (i >= childNodes.length) {\n      triedForward = true\n      i = index - 1\n      direction = 'backward'\n      continue\n    }\n\n    if (i < 0) {\n      triedBackward = true\n      i = index + 1\n      direction = 'forward'\n      continue\n    }\n\n    child = childNodes[i]\n    index = i\n    i += direction === 'forward' ? 1 : -1\n  }\n\n  return [child, index]\n}\n\n/**\n * Get the nearest editable child at `index` in a `parent`, preferring\n * `direction`.\n */\n\nexport const getEditableChild = (\n  parent: DOMElement,\n  index: number,\n  direction: 'forward' | 'backward'\n): DOMNode => {\n  const [child] = getEditableChildAndIndex(parent, index, direction)\n  return child\n}\n\n/**\n * Get a plaintext representation of the content of a node, accounting for block\n * elements which get a newline appended.\n *\n * The domNode must be attached to the DOM.\n */\n\nexport const getPlainText = (domNode: DOMNode) => {\n  let text = ''\n\n  if (isDOMText(domNode) && domNode.nodeValue) {\n    return domNode.nodeValue\n  }\n\n  if (isDOMElement(domNode)) {\n    for (const childNode of Array.from(domNode.childNodes)) {\n      text += getPlainText(childNode)\n    }\n\n    const display = getComputedStyle(domNode).getPropertyValue('display')\n\n    if (display === 'block' || display === 'list' || domNode.tagName === 'BR') {\n      text += '\\n'\n    }\n  }\n\n  return text\n}\n\n/**\n * Get x-slate-fragment attribute from data-slate-fragment\n */\nconst catchSlateFragment = /data-slate-fragment=\"(.+?)\"/m\nexport const getSlateFragmentAttribute = (\n  dataTransfer: DataTransfer\n): string | void => {\n  const htmlData = dataTransfer.getData('text/html')\n  const [, fragment] = htmlData.match(catchSlateFragment) || []\n  return fragment\n}\n\n/**\n * Get the x-slate-fragment attribute that exist in text/html data\n * and append it to the DataTransfer object\n */\nexport const getClipboardData = (\n  dataTransfer: DataTransfer,\n  clipboardFormatKey = 'x-slate-fragment'\n): DataTransfer => {\n  if (!dataTransfer.getData(`application/${clipboardFormatKey}`)) {\n    const fragment = getSlateFragmentAttribute(dataTransfer)\n    if (fragment) {\n      const clipboardData = new DataTransfer()\n      dataTransfer.types.forEach(type => {\n        clipboardData.setData(type, dataTransfer.getData(type))\n      })\n      clipboardData.setData(`application/${clipboardFormatKey}`, fragment)\n      return clipboardData\n    }\n  }\n  return dataTransfer\n}\n\n/**\n * Get the dom selection from Shadow Root if possible, otherwise from the document\n */\nexport const getSelection = (root: Document | ShadowRoot): Selection | null => {\n  if (root.getSelection != null) {\n    return root.getSelection()\n  }\n  return document.getSelection()\n}\n\n/**\n * Check whether a mutation originates from a editable element inside the editor.\n */\n\nexport const isTrackedMutation = (\n  editor: DOMEditor,\n  mutation: MutationRecord,\n  batch: MutationRecord[]\n): boolean => {\n  const { target } = mutation\n  if (isDOMElement(target) && target.matches('[contentEditable=\"false\"]')) {\n    return false\n  }\n\n  const { document } = DOMEditor.getWindow(editor)\n  if (document.contains(target)) {\n    return DOMEditor.hasDOMNode(editor, target, { editable: true })\n  }\n\n  const parentMutation = batch.find(({ addedNodes, removedNodes }) => {\n    for (const node of addedNodes) {\n      if (node === target || node.contains(target)) {\n        return true\n      }\n    }\n\n    for (const node of removedNodes) {\n      if (node === target || node.contains(target)) {\n        return true\n      }\n    }\n  })\n\n  if (!parentMutation || parentMutation === mutation) {\n    return false\n  }\n\n  // Target add/remove is tracked. Track the mutation if we track the parent mutation.\n  return isTrackedMutation(editor, parentMutation, batch)\n}\n\n/**\n * Retrieves the deepest active element in the DOM, considering nested shadow DOMs.\n */\nexport const getActiveElement = () => {\n  let activeElement = document.activeElement\n\n  while (activeElement?.shadowRoot && activeElement.shadowRoot?.activeElement) {\n    activeElement = activeElement?.shadowRoot?.activeElement\n  }\n\n  return activeElement\n}\n\n/**\n * @returns `true` if `otherNode` is before `node` in the document; otherwise, `false`.\n */\nexport const isBefore = (node: DOMNode, otherNode: DOMNode): boolean =>\n  Boolean(\n    node.compareDocumentPosition(otherNode) &\n      DOMNode.DOCUMENT_POSITION_PRECEDING\n  )\n\n/**\n * @returns `true` if `otherNode` is after `node` in the document; otherwise, `false`.\n */\nexport const isAfter = (node: DOMNode, otherNode: DOMNode): boolean =>\n  Boolean(\n    node.compareDocumentPosition(otherNode) &\n      DOMNode.DOCUMENT_POSITION_FOLLOWING\n  )\n","export const IS_IOS =\n  typeof navigator !== 'undefined' &&\n  typeof window !== 'undefined' &&\n  /iPad|iPhone|iPod/.test(navigator.userAgent) &&\n  !window.MSStream\n\nexport const IS_APPLE =\n  typeof navigator !== 'undefined' && /Mac OS X/.test(navigator.userAgent)\n\nexport const IS_ANDROID =\n  typeof navigator !== 'undefined' && /Android/.test(navigator.userAgent)\n\nexport const IS_FIREFOX =\n  typeof navigator !== 'undefined' &&\n  /^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent)\n\nexport const IS_WEBKIT =\n  typeof navigator !== 'undefined' &&\n  /AppleWebKit(?!.*Chrome)/i.test(navigator.userAgent)\n\n// \"modern\" Edge was released at 79.x\nexport const IS_EDGE_LEGACY =\n  typeof navigator !== 'undefined' &&\n  /Edge?\\/(?:[0-6][0-9]|[0-7][0-8])(?:\\.)/i.test(navigator.userAgent)\n\nexport const IS_CHROME =\n  typeof navigator !== 'undefined' && /Chrome/i.test(navigator.userAgent)\n\n// Native `beforeInput` events don't work well with react on Chrome 75\n// and older, Chrome 76+ can use `beforeInput` though.\nexport const IS_CHROME_LEGACY =\n  typeof navigator !== 'undefined' &&\n  /Chrome?\\/(?:[0-7][0-5]|[0-6][0-9])(?:\\.)/i.test(navigator.userAgent)\n\nexport const IS_ANDROID_CHROME_LEGACY =\n  IS_ANDROID &&\n  typeof navigator !== 'undefined' &&\n  /Chrome?\\/(?:[0-5]?\\d)(?:\\.)/i.test(navigator.userAgent)\n\n// Firefox did not support `beforeInput` until `v87`.\nexport const IS_FIREFOX_LEGACY =\n  typeof navigator !== 'undefined' &&\n  /^(?!.*Seamonkey)(?=.*Firefox\\/(?:[0-7][0-9]|[0-8][0-6])(?:\\.)).*/i.test(\n    navigator.userAgent\n  )\n\n// UC mobile browser\nexport const IS_UC_MOBILE =\n  typeof navigator !== 'undefined' && /.*UCBrowser/.test(navigator.userAgent)\n\n// Wechat browser (not including mac wechat)\nexport const IS_WECHATBROWSER =\n  typeof navigator !== 'undefined' &&\n  /.*Wechat/.test(navigator.userAgent) &&\n  !/.*MacWechat/.test(navigator.userAgent) // avoid lookbehind (buggy in safari < 16.4)\n\n// Check if DOM is available as React does internally.\n// https://github.com/facebook/react/blob/master/packages/shared/ExecutionEnvironment.js\nexport const CAN_USE_DOM = !!(\n  typeof window !== 'undefined' &&\n  typeof window.document !== 'undefined' &&\n  typeof window.document.createElement !== 'undefined'\n)\n\n// Check if the browser is Safari and older than 17\nexport const IS_SAFARI_LEGACY =\n  typeof navigator !== 'undefined' &&\n  /Safari/.test(navigator.userAgent) &&\n  /Version\\/(\\d+)/.test(navigator.userAgent) &&\n  (navigator.userAgent.match(/Version\\/(\\d+)/)?.[1]\n    ? parseInt(navigator.userAgent.match(/Version\\/(\\d+)/)?.[1]!, 10) < 17\n    : false)\n\n// COMPAT: Firefox/Edge Legacy don't support the `beforeinput` event\n// Chrome Legacy doesn't support `beforeinput` correctly\nexport const HAS_BEFORE_INPUT_SUPPORT =\n  (!IS_CHROME_LEGACY || !IS_ANDROID_CHROME_LEGACY) &&\n  !IS_EDGE_LEGACY &&\n  // globalThis is undefined in older browsers\n  typeof globalThis !== 'undefined' &&\n  globalThis.InputEvent &&\n  // @ts-ignore The `getTargetRanges` property isn't recognized.\n  typeof globalThis.InputEvent.prototype.getTargetRanges === 'function'\n","export default function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}","import _typeof from \"./typeof.js\";\nexport default function _toPrimitive(input, hint) {\n  if (_typeof(input) !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (_typeof(res) !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nexport default function _toPropertyKey(arg) {\n  var key = toPrimitive(arg, \"string\");\n  return _typeof(key) === \"symbol\" ? key : String(key);\n}","import toPropertyKey from \"./toPropertyKey.js\";\nexport default function _defineProperty(obj, key, value) {\n  key = toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}","/**\n * An auto-incrementing identifier for keys.\n */\n\nlet n = 0\n\n/**\n * A class that keeps track of a key string. We use a full class here because we\n * want to be able to use them as keys in `WeakMap` objects.\n */\n\nexport class Key {\n  id: string\n\n  constructor() {\n    this.id = `${n++}`\n  }\n}\n","import {\n  Ancestor,\n  Editor,\n  Node,\n  Operation,\n  Point,\n  Range,\n  RangeRef,\n  Text,\n} from 'slate'\nimport { TextDiff } from './diff-text'\nimport { Key } from './key'\n\nexport type Action = { at?: Point | Range; run: () => void }\n\n/**\n * Two weak maps that allow us rebuild a path given a node. They are populated\n * at render time such that after a render occurs we can always backtrack.\n */\nexport const IS_NODE_MAP_DIRTY: WeakMap<Editor, boolean> = new WeakMap()\nexport const NODE_TO_INDEX: WeakMap<Node, number> = new WeakMap()\nexport const NODE_TO_PARENT: WeakMap<Node, Ancestor> = new WeakMap()\n\n/**\n * Weak maps that allow us to go between Slate nodes and DOM nodes. These\n * are used to resolve DOM event-related logic into Slate actions.\n */\nexport const EDITOR_TO_WINDOW: WeakMap<Editor, Window> = new WeakMap()\nexport const EDITOR_TO_ELEMENT: WeakMap<Editor, HTMLElement> = new WeakMap()\nexport const EDITOR_TO_PLACEHOLDER: WeakMap<Editor, string> = new WeakMap()\nexport const EDITOR_TO_PLACEHOLDER_ELEMENT: WeakMap<Editor, HTMLElement> =\n  new WeakMap()\nexport const ELEMENT_TO_NODE: WeakMap<HTMLElement, Node> = new WeakMap()\nexport const NODE_TO_ELEMENT: WeakMap<Node, HTMLElement> = new WeakMap()\nexport const NODE_TO_KEY: WeakMap<Node, Key> = new WeakMap()\nexport const EDITOR_TO_KEY_TO_ELEMENT: WeakMap<\n  Editor,\n  WeakMap<Key, HTMLElement>\n> = new WeakMap()\n\n/**\n * Weak maps for storing editor-related state.\n */\n\nexport const IS_READ_ONLY: WeakMap<Editor, boolean> = new WeakMap()\nexport const IS_FOCUSED: WeakMap<Editor, boolean> = new WeakMap()\nexport const IS_COMPOSING: WeakMap<Editor, boolean> = new WeakMap()\n\nexport const EDITOR_TO_USER_SELECTION: WeakMap<Editor, RangeRef | null> =\n  new WeakMap()\n\n/**\n * Weak map for associating the context `onChange` context with the plugin.\n */\n\nexport const EDITOR_TO_ON_CHANGE = new WeakMap<\n  Editor,\n  (options?: { operation?: Operation }) => void\n>()\n\n/**\n * Weak maps for saving pending state on composition stage.\n */\n\nexport const EDITOR_TO_SCHEDULE_FLUSH: WeakMap<Editor, () => void> =\n  new WeakMap()\n\nexport const EDITOR_TO_PENDING_INSERTION_MARKS: WeakMap<\n  Editor,\n  Partial<Text> | null\n> = new WeakMap()\n\nexport const EDITOR_TO_USER_MARKS: WeakMap<Editor, Partial<Text> | null> =\n  new WeakMap()\n\n/**\n * Android input handling specific weak-maps\n */\n\nexport const EDITOR_TO_PENDING_DIFFS: WeakMap<Editor, TextDiff[]> =\n  new WeakMap()\n\nexport const EDITOR_TO_PENDING_ACTION: WeakMap<Editor, Action | null> =\n  new WeakMap()\n\nexport const EDITOR_TO_PENDING_SELECTION: WeakMap<Editor, Range | null> =\n  new WeakMap()\n\nexport const EDITOR_TO_FORCE_RENDER: WeakMap<Editor, () => void> = new WeakMap()\n\n/**\n * Symbols.\n */\n\nexport const PLACEHOLDER_SYMBOL = Symbol('placeholder') as unknown as string\nexport const MARK_PLACEHOLDER_SYMBOL = Symbol(\n  'mark-placeholder'\n) as unknown as string\n","import {\n  BaseEditor,\n  Editor,\n  Element,\n  Node,\n  Path,\n  Point,\n  Range,\n  Scrubber,\n  Transforms,\n} from 'slate'\nimport { TextDiff } from '../utils/diff-text'\nimport {\n  DOMElement,\n  DOMNode,\n  DOMPoint,\n  DOMRange,\n  DOMSelection,\n  DOMStaticRange,\n  DOMText,\n  getSelection,\n  hasShadowRoot,\n  isAfter,\n  isBefore,\n  isDOMElement,\n  isDOMNode,\n  isDOMSelection,\n  normalizeDOMPoint,\n} from '../utils/dom'\nimport { IS_ANDROID, IS_CHROME, IS_FIREFOX } from '../utils/environment'\n\nimport { Key } from '../utils/key'\nimport {\n  EDITOR_TO_ELEMENT,\n  EDITOR_TO_KEY_TO_ELEMENT,\n  EDITOR_TO_PENDING_DIFFS,\n  EDITOR_TO_SCHEDULE_FLUSH,\n  EDITOR_TO_WINDOW,\n  ELEMENT_TO_NODE,\n  IS_COMPOSING,\n  IS_FOCUSED,\n  IS_READ_ONLY,\n  NODE_TO_INDEX,\n  NODE_TO_KEY,\n  NODE_TO_PARENT,\n} from '../utils/weak-maps'\n\n/**\n * A DOM-specific version of the `Editor` interface.\n */\n\nexport interface DOMEditor extends BaseEditor {\n  hasEditableTarget: (\n    editor: DOMEditor,\n    target: EventTarget | null\n  ) => target is DOMNode\n  hasRange: (editor: DOMEditor, range: Range) => boolean\n  hasSelectableTarget: (\n    editor: DOMEditor,\n    target: EventTarget | null\n  ) => boolean\n  hasTarget: (\n    editor: DOMEditor,\n    target: EventTarget | null\n  ) => target is DOMNode\n  insertData: (data: DataTransfer) => void\n  insertFragmentData: (data: DataTransfer) => boolean\n  insertTextData: (data: DataTransfer) => boolean\n  isTargetInsideNonReadonlyVoid: (\n    editor: DOMEditor,\n    target: EventTarget | null\n  ) => boolean\n  setFragmentData: (\n    data: DataTransfer,\n    originEvent?: 'drag' | 'copy' | 'cut'\n  ) => void\n}\n\nexport interface DOMEditorInterface {\n  /**\n   * Experimental and android specific: Get pending diffs\n   */\n  androidPendingDiffs: (editor: Editor) => TextDiff[] | undefined\n\n  /**\n   * Experimental and android specific: Flush all pending diffs and cancel composition at the next possible time.\n   */\n  androidScheduleFlush: (editor: Editor) => void\n\n  /**\n   * Blur the editor.\n   */\n  blur: (editor: DOMEditor) => void\n\n  /**\n   * Deselect the editor.\n   */\n  deselect: (editor: DOMEditor) => void\n\n  /**\n   * Find the DOM node that implements DocumentOrShadowRoot for the editor.\n   */\n  findDocumentOrShadowRoot: (editor: DOMEditor) => Document | ShadowRoot\n\n  /**\n   * Get the target range from a DOM `event`.\n   */\n  findEventRange: (editor: DOMEditor, event: any) => Range\n\n  /**\n   * Find a key for a Slate node.\n   */\n  findKey: (editor: DOMEditor, node: Node) => Key\n\n  /**\n   * Find the path of Slate node.\n   */\n  findPath: (editor: DOMEditor, node: Node) => Path\n\n  /**\n   * Focus the editor.\n   */\n  focus: (editor: DOMEditor, options?: { retries: number }) => void\n\n  /**\n   * Return the host window of the current editor.\n   */\n  getWindow: (editor: DOMEditor) => Window\n\n  /**\n   * Check if a DOM node is within the editor.\n   */\n  hasDOMNode: (\n    editor: DOMEditor,\n    target: DOMNode,\n    options?: { editable?: boolean }\n  ) => boolean\n\n  /**\n   * Check if the target is editable and in the editor.\n   */\n  hasEditableTarget: (\n    editor: DOMEditor,\n    target: EventTarget | null\n  ) => target is DOMNode\n\n  /**\n   *\n   */\n  hasRange: (editor: DOMEditor, range: Range) => boolean\n\n  /**\n   * Check if the target can be selectable\n   */\n  hasSelectableTarget: (\n    editor: DOMEditor,\n    target: EventTarget | null\n  ) => boolean\n\n  /**\n   * Check if the target is in the editor.\n   */\n  hasTarget: (\n    editor: DOMEditor,\n    target: EventTarget | null\n  ) => target is DOMNode\n\n  /**\n   * Insert data from a `DataTransfer` into the editor.\n   */\n  insertData: (editor: DOMEditor, data: DataTransfer) => void\n\n  /**\n   * Insert fragment data from a `DataTransfer` into the editor.\n   */\n  insertFragmentData: (editor: DOMEditor, data: DataTransfer) => boolean\n\n  /**\n   * Insert text data from a `DataTransfer` into the editor.\n   */\n  insertTextData: (editor: DOMEditor, data: DataTransfer) => boolean\n\n  /**\n   * Check if the user is currently composing inside the editor.\n   */\n  isComposing: (editor: DOMEditor) => boolean\n\n  /**\n   * Check if the editor is focused.\n   */\n  isFocused: (editor: DOMEditor) => boolean\n\n  /**\n   * Check if the editor is in read-only mode.\n   */\n  isReadOnly: (editor: DOMEditor) => boolean\n\n  /**\n   * Check if the target is inside void and in an non-readonly editor.\n   */\n  isTargetInsideNonReadonlyVoid: (\n    editor: DOMEditor,\n    target: EventTarget | null\n  ) => boolean\n\n  /**\n   * Sets data from the currently selected fragment on a `DataTransfer`.\n   */\n  setFragmentData: (\n    editor: DOMEditor,\n    data: DataTransfer,\n    originEvent?: 'drag' | 'copy' | 'cut'\n  ) => void\n\n  /**\n   * Find the native DOM element from a Slate node.\n   */\n  toDOMNode: (editor: DOMEditor, node: Node) => HTMLElement\n\n  /**\n   * Find a native DOM selection point from a Slate point.\n   */\n  toDOMPoint: (editor: DOMEditor, point: Point) => DOMPoint\n\n  /**\n   * Find a native DOM range from a Slate `range`.\n   *\n   * Notice: the returned range will always be ordinal regardless of the direction of Slate `range` due to DOM API limit.\n   *\n   * there is no way to create a reverse DOM Range using Range.setStart/setEnd\n   * according to https://dom.spec.whatwg.org/#concept-range-bp-set.\n   */\n  toDOMRange: (editor: DOMEditor, range: Range) => DOMRange\n\n  /**\n   * Find a Slate node from a native DOM `element`.\n   */\n  toSlateNode: (editor: DOMEditor, domNode: DOMNode) => Node\n\n  /**\n   * Find a Slate point from a DOM selection's `domNode` and `domOffset`.\n   */\n  toSlatePoint: <T extends boolean>(\n    editor: DOMEditor,\n    domPoint: DOMPoint,\n    options: {\n      exactMatch: boolean\n      suppressThrow: T\n      /**\n       * The direction to search for Slate leaf nodes if `domPoint` is\n       * non-editable and non-void.\n       */\n      searchDirection?: 'forward' | 'backward'\n    }\n  ) => T extends true ? Point | null : Point\n\n  /**\n   * Find a Slate range from a DOM range or selection.\n   */\n  toSlateRange: <T extends boolean>(\n    editor: DOMEditor,\n    domRange: DOMRange | DOMStaticRange | DOMSelection,\n    options: {\n      exactMatch: boolean\n      suppressThrow: T\n    }\n  ) => T extends true ? Range | null : Range\n}\n\n// eslint-disable-next-line no-redeclare\nexport const DOMEditor: DOMEditorInterface = {\n  androidPendingDiffs: editor => EDITOR_TO_PENDING_DIFFS.get(editor),\n\n  androidScheduleFlush: editor => {\n    EDITOR_TO_SCHEDULE_FLUSH.get(editor)?.()\n  },\n\n  blur: editor => {\n    const el = DOMEditor.toDOMNode(editor, editor)\n    const root = DOMEditor.findDocumentOrShadowRoot(editor)\n    IS_FOCUSED.set(editor, false)\n\n    if (root.activeElement === el) {\n      el.blur()\n    }\n  },\n\n  deselect: editor => {\n    const { selection } = editor\n    const root = DOMEditor.findDocumentOrShadowRoot(editor)\n    const domSelection = getSelection(root)\n\n    if (domSelection && domSelection.rangeCount > 0) {\n      domSelection.removeAllRanges()\n    }\n\n    if (selection) {\n      Transforms.deselect(editor)\n    }\n  },\n\n  findDocumentOrShadowRoot: editor => {\n    const el = DOMEditor.toDOMNode(editor, editor)\n    const root = el.getRootNode()\n\n    if (root instanceof Document || root instanceof ShadowRoot) {\n      return root\n    }\n\n    return el.ownerDocument\n  },\n\n  findEventRange: (editor, event) => {\n    if ('nativeEvent' in event) {\n      event = event.nativeEvent\n    }\n\n    const { clientX: x, clientY: y, target } = event\n\n    if (x == null || y == null) {\n      throw new Error(`Cannot resolve a Slate range from a DOM event: ${event}`)\n    }\n\n    const node = DOMEditor.toSlateNode(editor, event.target)\n    const path = DOMEditor.findPath(editor, node)\n\n    // If the drop target is inside a void node, move it into either the\n    // next or previous node, depending on which side the `x` and `y`\n    // coordinates are closest to.\n    if (Element.isElement(node) && Editor.isVoid(editor, node)) {\n      const rect = target.getBoundingClientRect()\n      const isPrev = editor.isInline(node)\n        ? x - rect.left < rect.left + rect.width - x\n        : y - rect.top < rect.top + rect.height - y\n\n      const edge = Editor.point(editor, path, {\n        edge: isPrev ? 'start' : 'end',\n      })\n      const point = isPrev\n        ? Editor.before(editor, edge)\n        : Editor.after(editor, edge)\n\n      if (point) {\n        const range = Editor.range(editor, point)\n        return range\n      }\n    }\n\n    // Else resolve a range from the caret position where the drop occured.\n    let domRange\n    const { document } = DOMEditor.getWindow(editor)\n\n    // COMPAT: In Firefox, `caretRangeFromPoint` doesn't exist. (2016/07/25)\n    if (document.caretRangeFromPoint) {\n      domRange = document.caretRangeFromPoint(x, y)\n    } else {\n      const position = document.caretPositionFromPoint(x, y)\n\n      if (position) {\n        domRange = document.createRange()\n        domRange.setStart(position.offsetNode, position.offset)\n        domRange.setEnd(position.offsetNode, position.offset)\n      }\n    }\n\n    if (!domRange) {\n      throw new Error(`Cannot resolve a Slate range from a DOM event: ${event}`)\n    }\n\n    // Resolve a Slate range from the DOM range.\n    const range = DOMEditor.toSlateRange(editor, domRange, {\n      exactMatch: false,\n      suppressThrow: false,\n    })\n    return range\n  },\n\n  findKey: (editor, node) => {\n    let key = NODE_TO_KEY.get(node)\n\n    if (!key) {\n      key = new Key()\n      NODE_TO_KEY.set(node, key)\n    }\n\n    return key\n  },\n\n  findPath: (editor, node) => {\n    const path: Path = []\n    let child = node\n\n    while (true) {\n      const parent = NODE_TO_PARENT.get(child)\n\n      if (parent == null) {\n        if (Editor.isEditor(child)) {\n          return path\n        } else {\n          break\n        }\n      }\n\n      const i = NODE_TO_INDEX.get(child)\n\n      if (i == null) {\n        break\n      }\n\n      path.unshift(i)\n      child = parent\n    }\n\n    throw new Error(\n      `Unable to find the path for Slate node: ${Scrubber.stringify(node)}`\n    )\n  },\n\n  focus: (editor, options = { retries: 5 }) => {\n    // Return if already focused\n    if (IS_FOCUSED.get(editor)) {\n      return\n    }\n\n    // Retry setting focus if the editor has pending operations.\n    // The DOM (selection) is unstable while changes are applied.\n    // Retry until retries are exhausted or editor is focused.\n    if (options.retries <= 0) {\n      throw new Error(\n        'Could not set focus, editor seems stuck with pending operations'\n      )\n    }\n    if (editor.operations.length > 0) {\n      setTimeout(() => {\n        DOMEditor.focus(editor, { retries: options.retries - 1 })\n      }, 10)\n      return\n    }\n\n    const el = DOMEditor.toDOMNode(editor, editor)\n    const root = DOMEditor.findDocumentOrShadowRoot(editor)\n    if (root.activeElement !== el) {\n      // Ensure that the DOM selection state is set to the editor's selection\n      if (editor.selection && root instanceof Document) {\n        const domSelection = getSelection(root)\n        const domRange = DOMEditor.toDOMRange(editor, editor.selection)\n        domSelection?.removeAllRanges()\n        domSelection?.addRange(domRange)\n      }\n      // Create a new selection in the top of the document if missing\n      if (!editor.selection) {\n        Transforms.select(editor, Editor.start(editor, []))\n      }\n      // IS_FOCUSED should be set before calling el.focus() to ensure that\n      // FocusedContext is updated to the correct value\n      IS_FOCUSED.set(editor, true)\n      el.focus({ preventScroll: true })\n    }\n  },\n\n  getWindow: editor => {\n    const window = EDITOR_TO_WINDOW.get(editor)\n    if (!window) {\n      throw new Error('Unable to find a host window element for this editor')\n    }\n    return window\n  },\n\n  hasDOMNode: (editor, target, options = {}) => {\n    const { editable = false } = options\n    const editorEl = DOMEditor.toDOMNode(editor, editor)\n    let targetEl\n\n    // COMPAT: In Firefox, reading `target.nodeType` will throw an error if\n    // target is originating from an internal \"restricted\" element (e.g. a\n    // stepper arrow on a number input). (2018/05/04)\n    // https://github.com/ianstormtaylor/slate/issues/1819\n    try {\n      targetEl = (\n        isDOMElement(target) ? target : target.parentElement\n      ) as HTMLElement\n    } catch (err) {\n      if (\n        err instanceof Error &&\n        !err.message.includes('Permission denied to access property \"nodeType\"')\n      ) {\n        throw err\n      }\n    }\n\n    if (!targetEl) {\n      return false\n    }\n\n    return (\n      targetEl.closest(`[data-slate-editor]`) === editorEl &&\n      (!editable || targetEl.isContentEditable\n        ? true\n        : (typeof targetEl.isContentEditable === 'boolean' && // isContentEditable exists only on HTMLElement, and on other nodes it will be undefined\n            // this is the core logic that lets you know you got the right editor.selection instead of null when editor is contenteditable=\"false\"(readOnly)\n            targetEl.closest('[contenteditable=\"false\"]') === editorEl) ||\n          !!targetEl.getAttribute('data-slate-zero-width'))\n    )\n  },\n\n  hasEditableTarget: (editor, target): target is DOMNode =>\n    isDOMNode(target) &&\n    DOMEditor.hasDOMNode(editor, target, { editable: true }),\n\n  hasRange: (editor, range) => {\n    const { anchor, focus } = range\n    return (\n      Editor.hasPath(editor, anchor.path) && Editor.hasPath(editor, focus.path)\n    )\n  },\n\n  hasSelectableTarget: (editor, target) =>\n    DOMEditor.hasEditableTarget(editor, target) ||\n    DOMEditor.isTargetInsideNonReadonlyVoid(editor, target),\n\n  hasTarget: (editor, target): target is DOMNode =>\n    isDOMNode(target) && DOMEditor.hasDOMNode(editor, target),\n\n  insertData: (editor, data) => {\n    editor.insertData(data)\n  },\n\n  insertFragmentData: (editor, data) => editor.insertFragmentData(data),\n\n  insertTextData: (editor, data) => editor.insertTextData(data),\n\n  isComposing: editor => {\n    return !!IS_COMPOSING.get(editor)\n  },\n\n  isFocused: editor => !!IS_FOCUSED.get(editor),\n\n  isReadOnly: editor => !!IS_READ_ONLY.get(editor),\n\n  isTargetInsideNonReadonlyVoid: (editor, target) => {\n    if (IS_READ_ONLY.get(editor)) return false\n\n    const slateNode =\n      DOMEditor.hasTarget(editor, target) &&\n      DOMEditor.toSlateNode(editor, target)\n    return Element.isElement(slateNode) && Editor.isVoid(editor, slateNode)\n  },\n\n  setFragmentData: (editor, data, originEvent) =>\n    editor.setFragmentData(data, originEvent),\n\n  toDOMNode: (editor, node) => {\n    const KEY_TO_ELEMENT = EDITOR_TO_KEY_TO_ELEMENT.get(editor)\n    const domNode = Editor.isEditor(node)\n      ? EDITOR_TO_ELEMENT.get(editor)\n      : KEY_TO_ELEMENT?.get(DOMEditor.findKey(editor, node))\n\n    if (!domNode) {\n      throw new Error(\n        `Cannot resolve a DOM node from Slate node: ${Scrubber.stringify(node)}`\n      )\n    }\n\n    return domNode\n  },\n\n  toDOMPoint: (editor, point) => {\n    const [node] = Editor.node(editor, point.path)\n    const el = DOMEditor.toDOMNode(editor, node)\n    let domPoint: DOMPoint | undefined\n\n    // If we're inside a void node, force the offset to 0, otherwise the zero\n    // width spacing character will result in an incorrect offset of 1\n    if (Editor.void(editor, { at: point })) {\n      point = { path: point.path, offset: 0 }\n    }\n\n    // For each leaf, we need to isolate its content, which means filtering\n    // to its direct text and zero-width spans. (We have to filter out any\n    // other siblings that may have been rendered alongside them.)\n    const selector = `[data-slate-string], [data-slate-zero-width]`\n    const texts = Array.from(el.querySelectorAll(selector))\n    let start = 0\n\n    for (let i = 0; i < texts.length; i++) {\n      const text = texts[i]\n      const domNode = text.childNodes[0] as HTMLElement\n\n      if (domNode == null || domNode.textContent == null) {\n        continue\n      }\n\n      const { length } = domNode.textContent\n      const attr = text.getAttribute('data-slate-length')\n      const trueLength = attr == null ? length : parseInt(attr, 10)\n      const end = start + trueLength\n\n      // Prefer putting the selection inside the mark placeholder to ensure\n      // composed text is displayed with the correct marks.\n      const nextText = texts[i + 1]\n      if (\n        point.offset === end &&\n        nextText?.hasAttribute('data-slate-mark-placeholder')\n      ) {\n        const domText = nextText.childNodes[0]\n\n        domPoint = [\n          // COMPAT: If we don't explicity set the dom point to be on the actual\n          // dom text element, chrome will put the selection behind the actual dom\n          // text element, causing domRange.getBoundingClientRect() calls on a collapsed\n          // selection to return incorrect zero values (https://bugs.chromium.org/p/chromium/issues/detail?id=435438)\n          // which will cause issues when scrolling to it.\n          domText instanceof DOMText ? domText : nextText,\n          nextText.textContent?.startsWith('\\uFEFF') ? 1 : 0,\n        ]\n        break\n      }\n\n      if (point.offset <= end) {\n        const offset = Math.min(length, Math.max(0, point.offset - start))\n        domPoint = [domNode, offset]\n        break\n      }\n\n      start = end\n    }\n\n    if (!domPoint) {\n      throw new Error(\n        `Cannot resolve a DOM point from Slate point: ${Scrubber.stringify(\n          point\n        )}`\n      )\n    }\n\n    return domPoint\n  },\n\n  toDOMRange: (editor, range) => {\n    const { anchor, focus } = range\n    const isBackward = Range.isBackward(range)\n    const domAnchor = DOMEditor.toDOMPoint(editor, anchor)\n    const domFocus = Range.isCollapsed(range)\n      ? domAnchor\n      : DOMEditor.toDOMPoint(editor, focus)\n\n    const window = DOMEditor.getWindow(editor)\n    const domRange = window.document.createRange()\n    const [startNode, startOffset] = isBackward ? domFocus : domAnchor\n    const [endNode, endOffset] = isBackward ? domAnchor : domFocus\n\n    // A slate Point at zero-width Leaf always has an offset of 0 but a native DOM selection at\n    // zero-width node has an offset of 1 so we have to check if we are in a zero-width node and\n    // adjust the offset accordingly.\n    const startEl = (\n      isDOMElement(startNode) ? startNode : startNode.parentElement\n    ) as HTMLElement\n    const isStartAtZeroWidth = !!startEl.getAttribute('data-slate-zero-width')\n    const endEl = (\n      isDOMElement(endNode) ? endNode : endNode.parentElement\n    ) as HTMLElement\n    const isEndAtZeroWidth = !!endEl.getAttribute('data-slate-zero-width')\n\n    domRange.setStart(startNode, isStartAtZeroWidth ? 1 : startOffset)\n    domRange.setEnd(endNode, isEndAtZeroWidth ? 1 : endOffset)\n    return domRange\n  },\n\n  toSlateNode: (editor, domNode) => {\n    let domEl = isDOMElement(domNode) ? domNode : domNode.parentElement\n\n    if (domEl && !domEl.hasAttribute('data-slate-node')) {\n      domEl = domEl.closest(`[data-slate-node]`)\n    }\n\n    const node = domEl ? ELEMENT_TO_NODE.get(domEl as HTMLElement) : null\n\n    if (!node) {\n      throw new Error(`Cannot resolve a Slate node from DOM node: ${domEl}`)\n    }\n\n    return node\n  },\n\n  toSlatePoint: <T extends boolean>(\n    editor: DOMEditor,\n    domPoint: DOMPoint,\n    options: {\n      exactMatch: boolean\n      suppressThrow: T\n      searchDirection?: 'forward' | 'backward'\n    }\n  ): T extends true ? Point | null : Point => {\n    const { exactMatch, suppressThrow, searchDirection = 'backward' } = options\n    const [nearestNode, nearestOffset] = exactMatch\n      ? domPoint\n      : normalizeDOMPoint(domPoint)\n    const parentNode = nearestNode.parentNode as DOMElement\n    let textNode: DOMElement | null = null\n    let offset = 0\n\n    if (parentNode) {\n      const editorEl = DOMEditor.toDOMNode(editor, editor)\n      const potentialVoidNode = parentNode.closest('[data-slate-void=\"true\"]')\n      // Need to ensure that the closest void node is actually a void node\n      // within this editor, and not a void node within some parent editor. This can happen\n      // if this editor is within a void node of another editor (\"nested editors\", like in\n      // the \"Editable Voids\" example on the docs site).\n      const voidNode =\n        potentialVoidNode && editorEl.contains(potentialVoidNode)\n          ? potentialVoidNode\n          : null\n      const potentialNonEditableNode = parentNode.closest(\n        '[contenteditable=\"false\"]'\n      )\n      const nonEditableNode =\n        potentialNonEditableNode && editorEl.contains(potentialNonEditableNode)\n          ? potentialNonEditableNode\n          : null\n      let leafNode = parentNode.closest('[data-slate-leaf]')\n      let domNode: DOMElement | null = null\n\n      // Calculate how far into the text node the `nearestNode` is, so that we\n      // can determine what the offset relative to the text node is.\n      if (leafNode) {\n        textNode = leafNode.closest('[data-slate-node=\"text\"]')\n\n        if (textNode) {\n          const window = DOMEditor.getWindow(editor)\n          const range = window.document.createRange()\n          range.setStart(textNode, 0)\n          range.setEnd(nearestNode, nearestOffset)\n\n          const contents = range.cloneContents()\n          const removals = [\n            ...Array.prototype.slice.call(\n              contents.querySelectorAll('[data-slate-zero-width]')\n            ),\n            ...Array.prototype.slice.call(\n              contents.querySelectorAll('[contenteditable=false]')\n            ),\n          ]\n\n          removals.forEach(el => {\n            // COMPAT: While composing at the start of a text node, some keyboards put\n            // the text content inside the zero width space.\n            if (\n              IS_ANDROID &&\n              !exactMatch &&\n              el.hasAttribute('data-slate-zero-width') &&\n              el.textContent.length > 0 &&\n              el.textContext !== '\\uFEFF'\n            ) {\n              if (el.textContent.startsWith('\\uFEFF')) {\n                el.textContent = el.textContent.slice(1)\n              }\n\n              return\n            }\n\n            el!.parentNode!.removeChild(el)\n          })\n\n          // COMPAT: Edge has a bug where Range.prototype.toString() will\n          // convert \\n into \\r\\n. The bug causes a loop when slate-dom\n          // attempts to reposition its cursor to match the native position. Use\n          // textContent.length instead.\n          // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/10291116/\n          offset = contents.textContent!.length\n          domNode = textNode\n        }\n      } else if (voidNode) {\n        // For void nodes, the element with the offset key will be a cousin, not an\n        // ancestor, so find it by going down from the nearest void parent and taking the\n        // first one that isn't inside a nested editor.\n        const leafNodes = voidNode.querySelectorAll('[data-slate-leaf]')\n        for (let index = 0; index < leafNodes.length; index++) {\n          const current = leafNodes[index]\n          if (DOMEditor.hasDOMNode(editor, current)) {\n            leafNode = current\n            break\n          }\n        }\n\n        // COMPAT: In read-only editors the leaf is not rendered.\n        if (!leafNode) {\n          offset = 1\n        } else {\n          textNode = leafNode.closest('[data-slate-node=\"text\"]')!\n          domNode = leafNode\n          offset = domNode.textContent!.length\n          domNode.querySelectorAll('[data-slate-zero-width]').forEach(el => {\n            offset -= el.textContent!.length\n          })\n        }\n      } else if (nonEditableNode) {\n        // Find the edge of the nearest leaf in `searchDirection`\n        const getLeafNodes = (node: DOMElement | null | undefined) =>\n          node\n            ? node.querySelectorAll(\n                // Exclude leaf nodes in nested editors\n                '[data-slate-leaf]:not(:scope [data-slate-editor] [data-slate-leaf])'\n              )\n            : []\n        const elementNode = nonEditableNode.closest(\n          '[data-slate-node=\"element\"]'\n        )\n\n        if (searchDirection === 'forward') {\n          const leafNodes = [\n            ...getLeafNodes(elementNode),\n            ...getLeafNodes(elementNode?.nextElementSibling),\n          ]\n          leafNode =\n            leafNodes.find(leaf => isAfter(nonEditableNode, leaf)) ?? null\n        } else {\n          const leafNodes = [\n            ...getLeafNodes(elementNode?.previousElementSibling),\n            ...getLeafNodes(elementNode),\n          ]\n          leafNode =\n            leafNodes.findLast(leaf => isBefore(nonEditableNode, leaf)) ?? null\n        }\n\n        if (leafNode) {\n          textNode = leafNode.closest('[data-slate-node=\"text\"]')!\n          domNode = leafNode\n          if (searchDirection === 'forward') {\n            offset = 0\n          } else {\n            offset = domNode.textContent!.length\n            domNode.querySelectorAll('[data-slate-zero-width]').forEach(el => {\n              offset -= el.textContent!.length\n            })\n          }\n        }\n      }\n\n      if (\n        domNode &&\n        offset === domNode.textContent!.length &&\n        // COMPAT: Android IMEs might remove the zero width space while composing,\n        // and we don't add it for line-breaks.\n        IS_ANDROID &&\n        domNode.getAttribute('data-slate-zero-width') === 'z' &&\n        domNode.textContent?.startsWith('\\uFEFF') &&\n        // COMPAT: If the parent node is a Slate zero-width space, editor is\n        // because the text node should have no characters. However, during IME\n        // composition the ASCII characters will be prepended to the zero-width\n        // space, so subtract 1 from the offset to account for the zero-width\n        // space character.\n        (parentNode.hasAttribute('data-slate-zero-width') ||\n          // COMPAT: In Firefox, `range.cloneContents()` returns an extra trailing '\\n'\n          // when the document ends with a new-line character. This results in the offset\n          // length being off by one, so we need to subtract one to account for this.\n          (IS_FIREFOX && domNode.textContent?.endsWith('\\n\\n')))\n      ) {\n        offset--\n      }\n    }\n\n    if (IS_ANDROID && !textNode && !exactMatch) {\n      const node = parentNode.hasAttribute('data-slate-node')\n        ? parentNode\n        : parentNode.closest('[data-slate-node]')\n\n      if (node && DOMEditor.hasDOMNode(editor, node, { editable: true })) {\n        const slateNode = DOMEditor.toSlateNode(editor, node)\n        let { path, offset } = Editor.start(\n          editor,\n          DOMEditor.findPath(editor, slateNode)\n        )\n\n        if (!node.querySelector('[data-slate-leaf]')) {\n          offset = nearestOffset\n        }\n\n        return { path, offset } as T extends true ? Point | null : Point\n      }\n    }\n\n    if (!textNode) {\n      if (suppressThrow) {\n        return null as T extends true ? Point | null : Point\n      }\n      throw new Error(\n        `Cannot resolve a Slate point from DOM point: ${domPoint}`\n      )\n    }\n\n    // COMPAT: If someone is clicking from one Slate editor into another,\n    // the select event fires twice, once for the old editor's `element`\n    // first, and then afterwards for the correct `element`. (2017/03/03)\n    const slateNode = DOMEditor.toSlateNode(editor, textNode!)\n    const path = DOMEditor.findPath(editor, slateNode)\n    return { path, offset } as T extends true ? Point | null : Point\n  },\n\n  toSlateRange: <T extends boolean>(\n    editor: DOMEditor,\n    domRange: DOMRange | DOMStaticRange | DOMSelection,\n    options: {\n      exactMatch: boolean\n      suppressThrow: T\n    }\n  ): T extends true ? Range | null : Range => {\n    const { exactMatch, suppressThrow } = options\n    const el = isDOMSelection(domRange)\n      ? domRange.anchorNode\n      : domRange.startContainer\n    let anchorNode\n    let anchorOffset\n    let focusNode\n    let focusOffset\n    let isCollapsed\n\n    if (el) {\n      if (isDOMSelection(domRange)) {\n        // COMPAT: In firefox the normal seletion way does not work\n        // (https://github.com/ianstormtaylor/slate/pull/5486#issue-1820720223)\n        if (IS_FIREFOX && domRange.rangeCount > 1) {\n          focusNode = domRange.focusNode // Focus node works fine\n          const firstRange = domRange.getRangeAt(0)\n          const lastRange = domRange.getRangeAt(domRange.rangeCount - 1)\n\n          // Here we are in the contenteditable mode of a table in firefox\n          if (\n            focusNode instanceof HTMLTableRowElement &&\n            firstRange.startContainer instanceof HTMLTableRowElement &&\n            lastRange.startContainer instanceof HTMLTableRowElement\n          ) {\n            // HTMLElement, becouse Element is a slate element\n            function getLastChildren(element: HTMLElement): HTMLElement {\n              if (element.childElementCount > 0) {\n                return getLastChildren(<HTMLElement>element.children[0])\n              } else {\n                return element\n              }\n            }\n\n            const firstNodeRow = <HTMLTableRowElement>firstRange.startContainer\n            const lastNodeRow = <HTMLTableRowElement>lastRange.startContainer\n\n            // This should never fail as \"The HTMLElement interface represents any HTML element.\"\n            const firstNode = getLastChildren(\n              <HTMLElement>firstNodeRow.children[firstRange.startOffset]\n            )\n            const lastNode = getLastChildren(\n              <HTMLElement>lastNodeRow.children[lastRange.startOffset]\n            )\n\n            // Zero, as we allways take the right one as the anchor point\n            focusOffset = 0\n\n            if (lastNode.childNodes.length > 0) {\n              anchorNode = lastNode.childNodes[0]\n            } else {\n              anchorNode = lastNode\n            }\n\n            if (firstNode.childNodes.length > 0) {\n              focusNode = firstNode.childNodes[0]\n            } else {\n              focusNode = firstNode\n            }\n\n            if (lastNode instanceof HTMLElement) {\n              anchorOffset = (<HTMLElement>lastNode).innerHTML.length\n            } else {\n              // Fallback option\n              anchorOffset = 0\n            }\n          } else {\n            // This is the read only mode of a firefox table\n            // Right to left\n            if (firstRange.startContainer === focusNode) {\n              anchorNode = lastRange.endContainer\n              anchorOffset = lastRange.endOffset\n              focusOffset = firstRange.startOffset\n            } else {\n              // Left to right\n              anchorNode = firstRange.startContainer\n              anchorOffset = firstRange.endOffset\n              focusOffset = lastRange.startOffset\n            }\n          }\n        } else {\n          anchorNode = domRange.anchorNode\n          anchorOffset = domRange.anchorOffset\n          focusNode = domRange.focusNode\n          focusOffset = domRange.focusOffset\n        }\n\n        // COMPAT: There's a bug in chrome that always returns `true` for\n        // `isCollapsed` for a Selection that comes from a ShadowRoot.\n        // (2020/08/08)\n        // https://bugs.chromium.org/p/chromium/issues/detail?id=447523\n        // IsCollapsed might not work in firefox, but this will\n        if ((IS_CHROME && hasShadowRoot(anchorNode)) || IS_FIREFOX) {\n          isCollapsed =\n            domRange.anchorNode === domRange.focusNode &&\n            domRange.anchorOffset === domRange.focusOffset\n        } else {\n          isCollapsed = domRange.isCollapsed\n        }\n      } else {\n        anchorNode = domRange.startContainer\n        anchorOffset = domRange.startOffset\n        focusNode = domRange.endContainer\n        focusOffset = domRange.endOffset\n        isCollapsed = domRange.collapsed\n      }\n    }\n\n    if (\n      anchorNode == null ||\n      focusNode == null ||\n      anchorOffset == null ||\n      focusOffset == null\n    ) {\n      throw new Error(\n        `Cannot resolve a Slate range from DOM range: ${domRange}`\n      )\n    }\n\n    // COMPAT: Firefox sometimes includes an extra \\n (rendered by TextString\n    // when isTrailing is true) in the focusOffset, resulting in an invalid\n    // Slate point. (2023/11/01)\n    if (\n      IS_FIREFOX &&\n      focusNode.textContent?.endsWith('\\n\\n') &&\n      focusOffset === focusNode.textContent.length\n    ) {\n      focusOffset--\n    }\n\n    const anchor = DOMEditor.toSlatePoint(editor, [anchorNode, anchorOffset], {\n      exactMatch,\n      suppressThrow,\n    })\n    if (!anchor) {\n      return null as T extends true ? Range | null : Range\n    }\n\n    const focusBeforeAnchor =\n      isBefore(anchorNode, focusNode) ||\n      (anchorNode === focusNode && focusOffset < anchorOffset)\n    const focus = isCollapsed\n      ? anchor\n      : DOMEditor.toSlatePoint(editor, [focusNode, focusOffset], {\n          exactMatch,\n          suppressThrow,\n          searchDirection: focusBeforeAnchor ? 'forward' : 'backward',\n        })\n    if (!focus) {\n      return null as T extends true ? Range | null : Range\n    }\n\n    let range: Range = { anchor: anchor as Point, focus: focus as Point }\n    // if the selection is a hanging range that ends in a void\n    // and the DOM focus is an Element\n    // (meaning that the selection ends before the element)\n    // unhang the range to avoid mistakenly including the void\n    if (\n      Range.isExpanded(range) &&\n      Range.isForward(range) &&\n      isDOMElement(focusNode) &&\n      Editor.void(editor, { at: range.focus, mode: 'highest' })\n    ) {\n      range = Editor.unhangRange(editor, range, { voids: true })\n    }\n\n    return range as unknown as T extends true ? Range | null : Range\n  },\n}\n","import {\n  Editor,\n  Node,\n  Operation,\n  Path,\n  Point,\n  Range,\n  Text,\n  Element,\n} from 'slate'\nimport { EDITOR_TO_PENDING_DIFFS } from './weak-maps'\n\nexport type StringDiff = {\n  start: number\n  end: number\n  text: string\n}\n\nexport type TextDiff = {\n  id: number\n  path: Path\n  diff: StringDiff\n}\n\n/**\n * Check whether a text diff was applied in a way we can perform the pending action on /\n * recover the pending selection.\n */\nexport function verifyDiffState(editor: Editor, textDiff: TextDiff): boolean {\n  const { path, diff } = textDiff\n  if (!Editor.hasPath(editor, path)) {\n    return false\n  }\n\n  const node = Node.get(editor, path)\n  if (!Text.isText(node)) {\n    return false\n  }\n\n  if (diff.start !== node.text.length || diff.text.length === 0) {\n    return (\n      node.text.slice(diff.start, diff.start + diff.text.length) === diff.text\n    )\n  }\n\n  const nextPath = Path.next(path)\n  if (!Editor.hasPath(editor, nextPath)) {\n    return false\n  }\n\n  const nextNode = Node.get(editor, nextPath)\n  return Text.isText(nextNode) && nextNode.text.startsWith(diff.text)\n}\n\nexport function applyStringDiff(text: string, ...diffs: StringDiff[]) {\n  return diffs.reduce(\n    (text, diff) =>\n      text.slice(0, diff.start) + diff.text + text.slice(diff.end),\n    text\n  )\n}\n\nfunction longestCommonPrefixLength(str: string, another: string) {\n  const length = Math.min(str.length, another.length)\n\n  for (let i = 0; i < length; i++) {\n    if (str.charAt(i) !== another.charAt(i)) {\n      return i\n    }\n  }\n\n  return length\n}\n\nfunction longestCommonSuffixLength(\n  str: string,\n  another: string,\n  max: number\n): number {\n  const length = Math.min(str.length, another.length, max)\n\n  for (let i = 0; i < length; i++) {\n    if (\n      str.charAt(str.length - i - 1) !== another.charAt(another.length - i - 1)\n    ) {\n      return i\n    }\n  }\n\n  return length\n}\n\n/**\n * Remove redundant changes from the diff so that it spans the minimal possible range\n */\nexport function normalizeStringDiff(targetText: string, diff: StringDiff) {\n  const { start, end, text } = diff\n  const removedText = targetText.slice(start, end)\n\n  const prefixLength = longestCommonPrefixLength(removedText, text)\n  const max = Math.min(\n    removedText.length - prefixLength,\n    text.length - prefixLength\n  )\n  const suffixLength = longestCommonSuffixLength(removedText, text, max)\n\n  const normalized: StringDiff = {\n    start: start + prefixLength,\n    end: end - suffixLength,\n    text: text.slice(prefixLength, text.length - suffixLength),\n  }\n\n  if (normalized.start === normalized.end && normalized.text.length === 0) {\n    return null\n  }\n\n  return normalized\n}\n\n/**\n * Return a string diff that is equivalent to applying b after a spanning the range of\n * both changes\n */\nexport function mergeStringDiffs(\n  targetText: string,\n  a: StringDiff,\n  b: StringDiff\n): StringDiff | null {\n  const start = Math.min(a.start, b.start)\n  const overlap = Math.max(\n    0,\n    Math.min(a.start + a.text.length, b.end) - b.start\n  )\n\n  const applied = applyStringDiff(targetText, a, b)\n  const sliceEnd = Math.max(\n    b.start + b.text.length,\n    a.start +\n      a.text.length +\n      (a.start + a.text.length > b.start ? b.text.length : 0) -\n      overlap\n  )\n\n  const text = applied.slice(start, sliceEnd)\n  const end = Math.max(a.end, b.end - a.text.length + (a.end - a.start))\n  return normalizeStringDiff(targetText, { start, end, text })\n}\n\n/**\n * Get the slate range the text diff spans.\n */\nexport function targetRange(textDiff: TextDiff): Range {\n  const { path, diff } = textDiff\n  return {\n    anchor: { path, offset: diff.start },\n    focus: { path, offset: diff.end },\n  }\n}\n\n/**\n * Normalize a 'pending point' a.k.a a point based on the dom state before applying\n * the pending diffs. Since the pending diffs might have been inserted with different\n * marks we have to 'walk' the offset from the starting position to ensure we still\n * have a valid point inside the document\n */\nexport function normalizePoint(editor: Editor, point: Point): Point | null {\n  let { path, offset } = point\n  if (!Editor.hasPath(editor, path)) {\n    return null\n  }\n\n  let leaf = Node.get(editor, path)\n  if (!Text.isText(leaf)) {\n    return null\n  }\n\n  const parentBlock = Editor.above(editor, {\n    match: n => Element.isElement(n) && Editor.isBlock(editor, n),\n    at: path,\n  })\n\n  if (!parentBlock) {\n    return null\n  }\n\n  while (offset > leaf.text.length) {\n    const entry = Editor.next(editor, { at: path, match: Text.isText })\n    if (!entry || !Path.isDescendant(entry[1], parentBlock[1])) {\n      return null\n    }\n\n    offset -= leaf.text.length\n    leaf = entry[0]\n    path = entry[1]\n  }\n\n  return { path, offset }\n}\n\n/**\n * Normalize a 'pending selection' to ensure it's valid in the current document state.\n */\nexport function normalizeRange(editor: Editor, range: Range): Range | null {\n  const anchor = normalizePoint(editor, range.anchor)\n  if (!anchor) {\n    return null\n  }\n\n  if (Range.isCollapsed(range)) {\n    return { anchor, focus: anchor }\n  }\n\n  const focus = normalizePoint(editor, range.focus)\n  if (!focus) {\n    return null\n  }\n\n  return { anchor, focus }\n}\n\nexport function transformPendingPoint(\n  editor: Editor,\n  point: Point,\n  op: Operation\n): Point | null {\n  const pendingDiffs = EDITOR_TO_PENDING_DIFFS.get(editor)\n  const textDiff = pendingDiffs?.find(({ path }) =>\n    Path.equals(path, point.path)\n  )\n\n  if (!textDiff || point.offset <= textDiff.diff.start) {\n    return Point.transform(point, op, { affinity: 'backward' })\n  }\n\n  const { diff } = textDiff\n  // Point references location inside the diff => transform the point based on the location\n  // the diff will be applied to and add the offset inside the diff.\n  if (point.offset <= diff.start + diff.text.length) {\n    const anchor = { path: point.path, offset: diff.start }\n    const transformed = Point.transform(anchor, op, {\n      affinity: 'backward',\n    })\n\n    if (!transformed) {\n      return null\n    }\n\n    return {\n      path: transformed.path,\n      offset: transformed.offset + point.offset - diff.start,\n    }\n  }\n\n  // Point references location after the diff\n  const anchor = {\n    path: point.path,\n    offset: point.offset - diff.text.length + diff.end - diff.start,\n  }\n  const transformed = Point.transform(anchor, op, {\n    affinity: 'backward',\n  })\n  if (!transformed) {\n    return null\n  }\n\n  if (\n    op.type === 'split_node' &&\n    Path.equals(op.path, point.path) &&\n    anchor.offset < op.position &&\n    diff.start < op.position\n  ) {\n    return transformed\n  }\n\n  return {\n    path: transformed.path,\n    offset: transformed.offset + diff.text.length - diff.end + diff.start,\n  }\n}\n\nexport function transformPendingRange(\n  editor: Editor,\n  range: Range,\n  op: Operation\n): Range | null {\n  const anchor = transformPendingPoint(editor, range.anchor, op)\n  if (!anchor) {\n    return null\n  }\n\n  if (Range.isCollapsed(range)) {\n    return { anchor, focus: anchor }\n  }\n\n  const focus = transformPendingPoint(editor, range.focus, op)\n  if (!focus) {\n    return null\n  }\n\n  return { anchor, focus }\n}\n\nexport function transformTextDiff(\n  textDiff: TextDiff,\n  op: Operation\n): TextDiff | null {\n  const { path, diff, id } = textDiff\n\n  switch (op.type) {\n    case 'insert_text': {\n      if (!Path.equals(op.path, path) || op.offset >= diff.end) {\n        return textDiff\n      }\n\n      if (op.offset <= diff.start) {\n        return {\n          diff: {\n            start: op.text.length + diff.start,\n            end: op.text.length + diff.end,\n            text: diff.text,\n          },\n          id,\n          path,\n        }\n      }\n\n      return {\n        diff: {\n          start: diff.start,\n          end: diff.end + op.text.length,\n          text: diff.text,\n        },\n        id,\n        path,\n      }\n    }\n    case 'remove_text': {\n      if (!Path.equals(op.path, path) || op.offset >= diff.end) {\n        return textDiff\n      }\n\n      if (op.offset + op.text.length <= diff.start) {\n        return {\n          diff: {\n            start: diff.start - op.text.length,\n            end: diff.end - op.text.length,\n            text: diff.text,\n          },\n          id,\n          path,\n        }\n      }\n\n      return {\n        diff: {\n          start: diff.start,\n          end: diff.end - op.text.length,\n          text: diff.text,\n        },\n        id,\n        path,\n      }\n    }\n    case 'split_node': {\n      if (!Path.equals(op.path, path) || op.position >= diff.end) {\n        return {\n          diff,\n          id,\n          path: Path.transform(path, op, { affinity: 'backward' })!,\n        }\n      }\n\n      if (op.position > diff.start) {\n        return {\n          diff: {\n            start: diff.start,\n            end: Math.min(op.position, diff.end),\n            text: diff.text,\n          },\n          id,\n          path,\n        }\n      }\n\n      return {\n        diff: {\n          start: diff.start - op.position,\n          end: diff.end - op.position,\n          text: diff.text,\n        },\n        id,\n        path: Path.transform(path, op, { affinity: 'forward' })!,\n      }\n    }\n    case 'merge_node': {\n      if (!Path.equals(op.path, path)) {\n        return {\n          diff,\n          id,\n          path: Path.transform(path, op)!,\n        }\n      }\n\n      return {\n        diff: {\n          start: diff.start + op.position,\n          end: diff.end + op.position,\n          text: diff.text,\n        },\n        id,\n        path: Path.transform(path, op)!,\n      }\n    }\n  }\n\n  const newPath = Path.transform(path, op)\n  if (!newPath) {\n    return null\n  }\n\n  return {\n    diff,\n    path: newPath,\n    id,\n  }\n}\n","/**\n * Utilities for single-line deletion\n */\n\nimport { Editor, Range } from 'slate'\nimport { DOMEditor } from '../plugin/dom-editor'\n\nconst doRectsIntersect = (rect: DOMRect, compareRect: DOMRect) => {\n  const middle = (compareRect.top + compareRect.bottom) / 2\n\n  return rect.top <= middle && rect.bottom >= middle\n}\n\nconst areRangesSameLine = (editor: DOMEditor, range1: Range, range2: Range) => {\n  const rect1 = DOMEditor.toDOMRange(editor, range1).getBoundingClientRect()\n  const rect2 = DOMEditor.toDOMRange(editor, range2).getBoundingClientRect()\n\n  return doRectsIntersect(rect1, rect2) && doRectsIntersect(rect2, rect1)\n}\n\n/**\n * A helper utility that returns the end portion of a `Range`\n * which is located on a single line.\n *\n * @param {Editor} editor The editor object to compare against\n * @param {Range} parentRange The parent range to compare against\n * @returns {Range} A valid portion of the parentRange which is one a single line\n */\nexport const findCurrentLineRange = (\n  editor: DOMEditor,\n  parentRange: Range\n): Range => {\n  const parentRangeBoundary = Editor.range(editor, Range.end(parentRange))\n  const positions = Array.from(Editor.positions(editor, { at: parentRange }))\n\n  let left = 0\n  let right = positions.length\n  let middle = Math.floor(right / 2)\n\n  if (\n    areRangesSameLine(\n      editor,\n      Editor.range(editor, positions[left]),\n      parentRangeBoundary\n    )\n  ) {\n    return Editor.range(editor, positions[left], parentRangeBoundary)\n  }\n\n  if (positions.length < 2) {\n    return Editor.range(\n      editor,\n      positions[positions.length - 1],\n      parentRangeBoundary\n    )\n  }\n\n  while (middle !== positions.length && middle !== left) {\n    if (\n      areRangesSameLine(\n        editor,\n        Editor.range(editor, positions[middle]),\n        parentRangeBoundary\n      )\n    ) {\n      right = middle\n    } else {\n      left = middle\n    }\n\n    middle = Math.floor((left + right) / 2)\n  }\n\n  return Editor.range(editor, positions[left], parentRangeBoundary)\n}\n","import {\n  BaseEditor,\n  Editor,\n  Element,\n  Node,\n  Operation,\n  Path,\n  PathRef,\n  Point,\n  Range,\n  Transforms,\n} from 'slate'\nimport {\n  TextDiff,\n  transformPendingPoint,\n  transformPendingRange,\n  transformTextDiff,\n} from '../utils/diff-text'\nimport {\n  getPlainText,\n  getSlateFragmentAttribute,\n  isDOMText,\n} from '../utils/dom'\nimport { Key } from '../utils/key'\nimport { findCurrentLineRange } from '../utils/lines'\nimport {\n  IS_NODE_MAP_DIRTY,\n  EDITOR_TO_KEY_TO_ELEMENT,\n  EDITOR_TO_ON_CHANGE,\n  EDITOR_TO_PENDING_ACTION,\n  EDITOR_TO_PENDING_DIFFS,\n  EDITOR_TO_PENDING_INSERTION_MARKS,\n  EDITOR_TO_PENDING_SELECTION,\n  EDITOR_TO_SCHEDULE_FLUSH,\n  EDITOR_TO_USER_MARKS,\n  EDITOR_TO_USER_SELECTION,\n  NODE_TO_KEY,\n} from '../utils/weak-maps'\nimport { DOMEditor } from './dom-editor'\n\n/**\n * `withDOM` adds DOM specific behaviors to the editor.\n *\n * If you are using TypeScript, you must extend Slate's CustomTypes to use\n * this plugin.\n *\n * See https://docs.slatejs.org/concepts/11-typescript to learn how.\n */\n\nexport const withDOM = <T extends BaseEditor>(\n  editor: T,\n  clipboardFormatKey = 'x-slate-fragment'\n): T & DOMEditor => {\n  const e = editor as T & DOMEditor\n  const { apply, onChange, deleteBackward, addMark, removeMark } = e\n\n  // The WeakMap which maps a key to a specific HTMLElement must be scoped to the editor instance to\n  // avoid collisions between editors in the DOM that share the same value.\n  EDITOR_TO_KEY_TO_ELEMENT.set(e, new WeakMap())\n\n  e.addMark = (key, value) => {\n    EDITOR_TO_SCHEDULE_FLUSH.get(e)?.()\n\n    if (\n      !EDITOR_TO_PENDING_INSERTION_MARKS.get(e) &&\n      EDITOR_TO_PENDING_DIFFS.get(e)?.length\n    ) {\n      // Ensure the current pending diffs originating from changes before the addMark\n      // are applied with the current formatting\n      EDITOR_TO_PENDING_INSERTION_MARKS.set(e, null)\n    }\n\n    EDITOR_TO_USER_MARKS.delete(e)\n\n    addMark(key, value)\n  }\n\n  e.removeMark = key => {\n    if (\n      !EDITOR_TO_PENDING_INSERTION_MARKS.get(e) &&\n      EDITOR_TO_PENDING_DIFFS.get(e)?.length\n    ) {\n      // Ensure the current pending diffs originating from changes before the addMark\n      // are applied with the current formatting\n      EDITOR_TO_PENDING_INSERTION_MARKS.set(e, null)\n    }\n\n    EDITOR_TO_USER_MARKS.delete(e)\n\n    removeMark(key)\n  }\n\n  e.deleteBackward = unit => {\n    if (unit !== 'line') {\n      return deleteBackward(unit)\n    }\n\n    if (e.selection && Range.isCollapsed(e.selection)) {\n      const parentBlockEntry = Editor.above(e, {\n        match: n => Element.isElement(n) && Editor.isBlock(e, n),\n        at: e.selection,\n      })\n\n      if (parentBlockEntry) {\n        const [, parentBlockPath] = parentBlockEntry\n        const parentElementRange = Editor.range(\n          e,\n          parentBlockPath,\n          e.selection.anchor\n        )\n\n        const currentLineRange = findCurrentLineRange(e, parentElementRange)\n\n        if (!Range.isCollapsed(currentLineRange)) {\n          Transforms.delete(e, { at: currentLineRange })\n        }\n      }\n    }\n  }\n\n  // This attempts to reset the NODE_TO_KEY entry to the correct value\n  // as apply() changes the object reference and hence invalidates the NODE_TO_KEY entry\n  e.apply = (op: Operation) => {\n    const matches: [Path, Key][] = []\n    const pathRefMatches: [PathRef, Key][] = []\n\n    const pendingDiffs = EDITOR_TO_PENDING_DIFFS.get(e)\n    if (pendingDiffs?.length) {\n      const transformed = pendingDiffs\n        .map(textDiff => transformTextDiff(textDiff, op))\n        .filter(Boolean) as TextDiff[]\n\n      EDITOR_TO_PENDING_DIFFS.set(e, transformed)\n    }\n\n    const pendingSelection = EDITOR_TO_PENDING_SELECTION.get(e)\n    if (pendingSelection) {\n      EDITOR_TO_PENDING_SELECTION.set(\n        e,\n        transformPendingRange(e, pendingSelection, op)\n      )\n    }\n\n    const pendingAction = EDITOR_TO_PENDING_ACTION.get(e)\n    if (pendingAction?.at) {\n      const at = Point.isPoint(pendingAction?.at)\n        ? transformPendingPoint(e, pendingAction.at, op)\n        : transformPendingRange(e, pendingAction.at, op)\n\n      EDITOR_TO_PENDING_ACTION.set(e, at ? { ...pendingAction, at } : null)\n    }\n\n    switch (op.type) {\n      case 'insert_text':\n      case 'remove_text':\n      case 'set_node':\n      case 'split_node': {\n        matches.push(...getMatches(e, op.path))\n        break\n      }\n\n      case 'set_selection': {\n        // Selection was manually set, don't restore the user selection after the change.\n        EDITOR_TO_USER_SELECTION.get(e)?.unref()\n        EDITOR_TO_USER_SELECTION.delete(e)\n        break\n      }\n\n      case 'insert_node':\n      case 'remove_node': {\n        matches.push(...getMatches(e, Path.parent(op.path)))\n        break\n      }\n\n      case 'merge_node': {\n        const prevPath = Path.previous(op.path)\n        matches.push(...getMatches(e, prevPath))\n        break\n      }\n\n      case 'move_node': {\n        const commonPath = Path.common(\n          Path.parent(op.path),\n          Path.parent(op.newPath)\n        )\n        matches.push(...getMatches(e, commonPath))\n\n        let changedPath: Path\n        if (Path.isBefore(op.path, op.newPath)) {\n          matches.push(...getMatches(e, Path.parent(op.path)))\n          changedPath = op.newPath\n        } else {\n          matches.push(...getMatches(e, Path.parent(op.newPath)))\n          changedPath = op.path\n        }\n\n        const changedNode = Node.get(editor, Path.parent(changedPath))\n        const changedNodeKey = DOMEditor.findKey(e, changedNode)\n        const changedPathRef = Editor.pathRef(e, Path.parent(changedPath))\n        pathRefMatches.push([changedPathRef, changedNodeKey])\n\n        break\n      }\n    }\n\n    apply(op)\n\n    switch (op.type) {\n      case 'insert_node':\n      case 'remove_node':\n      case 'merge_node':\n      case 'move_node':\n      case 'split_node':\n      case 'insert_text':\n      case 'remove_text':\n      case 'set_selection': {\n        // FIXME: Rename to something like IS_DOM_EDITOR_DESYNCED\n        // to better reflect reality, see #5792\n        IS_NODE_MAP_DIRTY.set(e, true)\n      }\n    }\n\n    for (const [path, key] of matches) {\n      const [node] = Editor.node(e, path)\n      NODE_TO_KEY.set(node, key)\n    }\n\n    for (const [pathRef, key] of pathRefMatches) {\n      if (pathRef.current) {\n        const [node] = Editor.node(e, pathRef.current)\n        NODE_TO_KEY.set(node, key)\n      }\n\n      pathRef.unref()\n    }\n  }\n\n  e.setFragmentData = (data: Pick<DataTransfer, 'getData' | 'setData'>) => {\n    const { selection } = e\n\n    if (!selection) {\n      return\n    }\n\n    const [start, end] = Range.edges(selection)\n    const startVoid = Editor.void(e, { at: start.path })\n    const endVoid = Editor.void(e, { at: end.path })\n\n    if (Range.isCollapsed(selection) && !startVoid) {\n      return\n    }\n\n    // Create a fake selection so that we can add a Base64-encoded copy of the\n    // fragment to the HTML, to decode on future pastes.\n    const domRange = DOMEditor.toDOMRange(e, selection)\n    let contents = domRange.cloneContents()\n    let attach = contents.childNodes[0] as HTMLElement\n\n    // Make sure attach is non-empty, since empty nodes will not get copied.\n    contents.childNodes.forEach(node => {\n      if (node.textContent && node.textContent.trim() !== '') {\n        attach = node as HTMLElement\n      }\n    })\n\n    // COMPAT: If the end node is a void node, we need to move the end of the\n    // range from the void node's spacer span, to the end of the void node's\n    // content, since the spacer is before void's content in the DOM.\n    if (endVoid) {\n      const [voidNode] = endVoid\n      const r = domRange.cloneRange()\n      const domNode = DOMEditor.toDOMNode(e, voidNode)\n      r.setEndAfter(domNode)\n      contents = r.cloneContents()\n    }\n\n    // COMPAT: If the start node is a void node, we need to attach the encoded\n    // fragment to the void node's content node instead of the spacer, because\n    // attaching it to empty `<div>/<span>` nodes will end up having it erased by\n    // most browsers. (2018/04/27)\n    if (startVoid) {\n      attach = contents.querySelector('[data-slate-spacer]')! as HTMLElement\n    }\n\n    // Remove any zero-width space spans from the cloned DOM so that they don't\n    // show up elsewhere when pasted.\n    Array.from(contents.querySelectorAll('[data-slate-zero-width]')).forEach(\n      zw => {\n        const isNewline = zw.getAttribute('data-slate-zero-width') === 'n'\n        zw.textContent = isNewline ? '\\n' : ''\n      }\n    )\n\n    // Set a `data-slate-fragment` attribute on a non-empty node, so it shows up\n    // in the HTML, and can be used for intra-Slate pasting. If it's a text\n    // node, wrap it in a `<span>` so we have something to set an attribute on.\n    if (isDOMText(attach)) {\n      const span = attach.ownerDocument.createElement('span')\n      // COMPAT: In Chrome and Safari, if we don't add the `white-space` style\n      // then leading and trailing spaces will be ignored. (2017/09/21)\n      span.style.whiteSpace = 'pre'\n      span.appendChild(attach)\n      contents.appendChild(span)\n      attach = span\n    }\n\n    const fragment = e.getFragment()\n    const string = JSON.stringify(fragment)\n    const encoded = window.btoa(encodeURIComponent(string))\n    attach.setAttribute('data-slate-fragment', encoded)\n    data.setData(`application/${clipboardFormatKey}`, encoded)\n\n    // Add the content to a <div> so that we can get its inner HTML.\n    const div = contents.ownerDocument.createElement('div')\n    div.appendChild(contents)\n    div.setAttribute('hidden', 'true')\n    contents.ownerDocument.body.appendChild(div)\n    data.setData('text/html', div.innerHTML)\n    data.setData('text/plain', getPlainText(div))\n    contents.ownerDocument.body.removeChild(div)\n    return data\n  }\n\n  e.insertData = (data: DataTransfer) => {\n    if (!e.insertFragmentData(data)) {\n      e.insertTextData(data)\n    }\n  }\n\n  e.insertFragmentData = (data: DataTransfer): boolean => {\n    /**\n     * Checking copied fragment from application/x-slate-fragment or data-slate-fragment\n     */\n    const fragment =\n      data.getData(`application/${clipboardFormatKey}`) ||\n      getSlateFragmentAttribute(data)\n\n    if (fragment) {\n      const decoded = decodeURIComponent(window.atob(fragment))\n      const parsed = JSON.parse(decoded) as Node[]\n      e.insertFragment(parsed)\n      return true\n    }\n    return false\n  }\n\n  e.insertTextData = (data: DataTransfer): boolean => {\n    const text = data.getData('text/plain')\n\n    if (text) {\n      const lines = text.split(/\\r\\n|\\r|\\n/)\n      let split = false\n\n      for (const line of lines) {\n        if (split) {\n          Transforms.splitNodes(e, { always: true })\n        }\n\n        e.insertText(line)\n        split = true\n      }\n      return true\n    }\n    return false\n  }\n\n  e.onChange = options => {\n    const onContextChange = EDITOR_TO_ON_CHANGE.get(e)\n\n    if (onContextChange) {\n      onContextChange(options)\n    }\n\n    onChange(options)\n  }\n\n  return e\n}\n\nconst getMatches = (e: Editor, path: Path) => {\n  const matches: [Path, Key][] = []\n  for (const [n, p] of Editor.levels(e, { at: path })) {\n    const key = DOMEditor.findKey(e, n)\n    matches.push([p, key])\n  }\n  return matches\n}\n","export const TRIPLE_CLICK = 3\n","import { isHotkey } from 'is-hotkey'\nimport { IS_APPLE } from './environment'\n\n/**\n * Hotkey mappings for each platform.\n */\n\nconst HOTKEYS = {\n  bold: 'mod+b',\n  compose: ['down', 'left', 'right', 'up', 'backspace', 'enter'],\n  moveBackward: 'left',\n  moveForward: 'right',\n  moveWordBackward: 'ctrl+left',\n  moveWordForward: 'ctrl+right',\n  deleteBackward: 'shift?+backspace',\n  deleteForward: 'shift?+delete',\n  extendBackward: 'shift+left',\n  extendForward: 'shift+right',\n  italic: 'mod+i',\n  insertSoftBreak: 'shift+enter',\n  splitBlock: 'enter',\n  undo: 'mod+z',\n}\n\nconst APPLE_HOTKEYS = {\n  moveLineBackward: 'opt+up',\n  moveLineForward: 'opt+down',\n  moveWordBackward: 'opt+left',\n  moveWordForward: 'opt+right',\n  deleteBackward: ['ctrl+backspace', 'ctrl+h'],\n  deleteForward: ['ctrl+delete', 'ctrl+d'],\n  deleteLineBackward: 'cmd+shift?+backspace',\n  deleteLineForward: ['cmd+shift?+delete', 'ctrl+k'],\n  deleteWordBackward: 'opt+shift?+backspace',\n  deleteWordForward: 'opt+shift?+delete',\n  extendLineBackward: 'opt+shift+up',\n  extendLineForward: 'opt+shift+down',\n  redo: 'cmd+shift+z',\n  transposeCharacter: 'ctrl+t',\n}\n\nconst WINDOWS_HOTKEYS = {\n  deleteWordBackward: 'ctrl+shift?+backspace',\n  deleteWordForward: 'ctrl+shift?+delete',\n  redo: ['ctrl+y', 'ctrl+shift+z'],\n}\n\n/**\n * Create a platform-aware hotkey checker.\n */\n\nconst create = (key: string) => {\n  const generic = HOTKEYS[<keyof typeof HOTKEYS>key]\n  const apple = APPLE_HOTKEYS[<keyof typeof APPLE_HOTKEYS>key]\n  const windows = WINDOWS_HOTKEYS[<keyof typeof WINDOWS_HOTKEYS>key]\n  const isGeneric = generic && isHotkey(generic)\n  const isApple = apple && isHotkey(apple)\n  const isWindows = windows && isHotkey(windows)\n\n  return (event: KeyboardEvent) => {\n    if (isGeneric && isGeneric(event)) return true\n    if (IS_APPLE && isApple && isApple(event)) return true\n    if (!IS_APPLE && isWindows && isWindows(event)) return true\n    return false\n  }\n}\n\n/**\n * Hotkeys.\n */\n\nexport default {\n  isBold: create('bold'),\n  isCompose: create('compose'),\n  isMoveBackward: create('moveBackward'),\n  isMoveForward: create('moveForward'),\n  isDeleteBackward: create('deleteBackward'),\n  isDeleteForward: create('deleteForward'),\n  isDeleteLineBackward: create('deleteLineBackward'),\n  isDeleteLineForward: create('deleteLineForward'),\n  isDeleteWordBackward: create('deleteWordBackward'),\n  isDeleteWordForward: create('deleteWordForward'),\n  isExtendBackward: create('extendBackward'),\n  isExtendForward: create('extendForward'),\n  isExtendLineBackward: create('extendLineBackward'),\n  isExtendLineForward: create('extendLineForward'),\n  isItalic: create('italic'),\n  isMoveLineBackward: create('moveLineBackward'),\n  isMoveLineForward: create('moveLineForward'),\n  isMoveWordBackward: create('moveWordBackward'),\n  isMoveWordForward: create('moveWordForward'),\n  isRedo: create('redo'),\n  isSoftBreak: create('insertSoftBreak'),\n  isSplitBlock: create('splitBlock'),\n  isTransposeCharacter: create('transposeCharacter'),\n  isUndo: create('undo'),\n}\n","export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n  return target;\n}","import objectWithoutPropertiesLoose from \"./objectWithoutPropertiesLoose.js\";\nexport default function _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n  return target;\n}","import { Ancestor, DecoratedRange, Editor, Range } from 'slate'\nimport { PLACEHOLDER_SYMBOL } from './weak-maps'\nimport { DOMEditor } from '../plugin/dom-editor'\n\nexport const shallowCompare = (\n  obj1: { [key: string]: unknown },\n  obj2: { [key: string]: unknown }\n) =>\n  Object.keys(obj1).length === Object.keys(obj2).length &&\n  Object.keys(obj1).every(\n    key => obj2.hasOwnProperty(key) && obj1[key] === obj2[key]\n  )\n\nconst isDecorationFlagsEqual = (range: Range, other: Range) => {\n  const { anchor: rangeAnchor, focus: rangeFocus, ...rangeOwnProps } = range\n  const { anchor: otherAnchor, focus: otherFocus, ...otherOwnProps } = other\n\n  return (\n    range[PLACEHOLDER_SYMBOL] === other[PLACEHOLDER_SYMBOL] &&\n    shallowCompare(rangeOwnProps, otherOwnProps)\n  )\n}\n\n/**\n * Check if a list of decorator ranges are equal to another.\n *\n * PERF: this requires the two lists to also have the ranges inside them in the\n * same order, but this is an okay constraint for us since decorations are\n * kept in order, and the odd case where they aren't is okay to re-render for.\n */\n\nexport const isElementDecorationsEqual = (\n  list: Range[] | null,\n  another: Range[] | null\n): boolean => {\n  if (list === another) {\n    return true\n  }\n\n  if (!list || !another) {\n    return false\n  }\n\n  if (list.length !== another.length) {\n    return false\n  }\n\n  for (let i = 0; i < list.length; i++) {\n    const range = list[i]\n    const other = another[i]\n\n    if (!Range.equals(range, other) || !isDecorationFlagsEqual(range, other)) {\n      return false\n    }\n  }\n\n  return true\n}\n\n/**\n * Check if a list of decorator ranges are equal to another.\n *\n * PERF: this requires the two lists to also have the ranges inside them in the\n * same order, but this is an okay constraint for us since decorations are\n * kept in order, and the odd case where they aren't is okay to re-render for.\n */\n\nexport const isTextDecorationsEqual = (\n  list: Range[] | null,\n  another: Range[] | null\n): boolean => {\n  if (list === another) {\n    return true\n  }\n\n  if (!list || !another) {\n    return false\n  }\n\n  if (list.length !== another.length) {\n    return false\n  }\n\n  for (let i = 0; i < list.length; i++) {\n    const range = list[i]\n    const other = another[i]\n\n    // compare only offsets because paths doesn't matter for text\n    if (\n      range.anchor.offset !== other.anchor.offset ||\n      range.focus.offset !== other.focus.offset ||\n      !isDecorationFlagsEqual(range, other)\n    ) {\n      return false\n    }\n  }\n\n  return true\n}\n\n/**\n * Split and group decorations by each child of a node.\n *\n * @returns An array with length equal to that of `node.children`. Each index\n * corresponds to a child of `node`, and the value is an array of decorations\n * for that child.\n */\n\nexport const splitDecorationsByChild = (\n  editor: Editor,\n  node: Ancestor,\n  decorations: DecoratedRange[]\n): DecoratedRange[][] => {\n  const decorationsByChild = Array.from(\n    node.children,\n    (): DecoratedRange[] => []\n  )\n\n  if (decorations.length === 0) {\n    return decorationsByChild\n  }\n\n  const path = DOMEditor.findPath(editor, node)\n  const level = path.length\n  const ancestorRange = Editor.range(editor, path)\n\n  const cachedChildRanges = new Array<Range | undefined>(node.children.length)\n\n  const getChildRange = (index: number) => {\n    const cachedRange = cachedChildRanges[index]\n    if (cachedRange) return cachedRange\n    const childRange = Editor.range(editor, [...path, index])\n    cachedChildRanges[index] = childRange\n    return childRange\n  }\n\n  for (const decoration of decorations) {\n    const decorationRange = Range.intersection(ancestorRange, decoration)\n    if (!decorationRange) continue\n\n    const [startPoint, endPoint] = Range.edges(decorationRange)\n    const startIndex = startPoint.path[level]\n    const endIndex = endPoint.path[level]\n\n    for (let i = startIndex; i <= endIndex; i++) {\n      const ds = decorationsByChild[i]\n      if (!ds) continue\n\n      const childRange = getChildRange(i)\n      const childDecorationRange = Range.intersection(childRange, decoration)\n      if (!childDecorationRange) continue\n\n      ds.push({\n        ...decoration,\n        ...childDecorationRange,\n      })\n    }\n  }\n\n  return decorationsByChild\n}\n"],"names":["DOMNode","globalThis","Node","DOMElement","Element","DOMText","Text","DOMRange","Range","DOMSelection","Selection","DOMStaticRange","StaticRange","getDefaultView","value","ownerDocument","defaultView","isDOMComment","isDOMNode","nodeType","isDOMElement","window","isDOMSelection","anchorNode","isDOMText","isPlainTextOnlyPaste","event","clipboardData","getData","types","length","normalizeDOMPoint","domPoint","node","offset","childNodes","isLast","index","getEditableChildAndIndex","i","getEditableChild","textContent","hasShadowRoot","parent","parentNode","toString","direction","child","triedForward","triedBackward","getAttribute","getPlainText","domNode","text","nodeValue","childNode","Array","from","display","getComputedStyle","getPropertyValue","tagName","catchSlateFragment","getSlateFragmentAttribute","dataTransfer","htmlData","fragment","match","getSelection","root","document","isTrackedMutation","editor","mutation","batch","target","matches","DOMEditor","getWindow","contains","hasDOMNode","editable","parentMutation","find","_ref","addedNodes","removedNodes","getActiveElement","activeElement","_activeElement","shadowRoot","_activeElement$shadow","_activeElement2","isBefore","otherNode","Boolean","compareDocumentPosition","DOCUMENT_POSITION_PRECEDING","isAfter","DOCUMENT_POSITION_FOLLOWING","IS_IOS","navigator","test","userAgent","MSStream","IS_APPLE","IS_ANDROID","IS_FIREFOX","IS_WEBKIT","IS_EDGE_LEGACY","IS_CHROME","IS_CHROME_LEGACY","IS_ANDROID_CHROME_LEGACY","IS_FIREFOX_LEGACY","IS_UC_MOBILE","IS_WECHATBROWSER","CAN_USE_DOM","createElement","_navigator$userAgent$","parseInt","_navigator$userAgent$2","HAS_BEFORE_INPUT_SUPPORT","InputEvent","prototype","getTargetRanges","toPrimitive","toPropertyKey","n","Key","constructor","_defineProperty","id","concat","IS_NODE_MAP_DIRTY","WeakMap","NODE_TO_INDEX","NODE_TO_PARENT","EDITOR_TO_WINDOW","EDITOR_TO_ELEMENT","EDITOR_TO_PLACEHOLDER_ELEMENT","ELEMENT_TO_NODE","NODE_TO_ELEMENT","NODE_TO_KEY","EDITOR_TO_KEY_TO_ELEMENT","IS_READ_ONLY","IS_FOCUSED","IS_COMPOSING","EDITOR_TO_USER_SELECTION","EDITOR_TO_ON_CHANGE","EDITOR_TO_SCHEDULE_FLUSH","EDITOR_TO_PENDING_INSERTION_MARKS","EDITOR_TO_USER_MARKS","EDITOR_TO_PENDING_DIFFS","EDITOR_TO_PENDING_ACTION","EDITOR_TO_PENDING_SELECTION","EDITOR_TO_FORCE_RENDER","PLACEHOLDER_SYMBOL","Symbol","MARK_PLACEHOLDER_SYMBOL","androidPendingDiffs","get","androidScheduleFlush","_EDITOR_TO_SCHEDULE_F","blur","el","toDOMNode","findDocumentOrShadowRoot","set","deselect","selection","domSelection","rangeCount","removeAllRanges","Transforms","getRootNode","Document","ShadowRoot","findEventRange","nativeEvent","clientX","x","clientY","y","Error","toSlateNode","path","findPath","isElement","Editor","isVoid","rect","getBoundingClientRect","isPrev","isInline","left","width","top","height","edge","point","before","after","range","domRange","caretRangeFromPoint","position","caretPositionFromPoint","createRange","setStart","offsetNode","setEnd","toSlateRange","exactMatch","suppressThrow","findKey","key","isEditor","unshift","Scrubber","stringify","focus","options","arguments","undefined","retries","operations","setTimeout","toDOMRange","addRange","select","start","preventScroll","editorEl","targetEl","parentElement","err","message","includes","closest","isContentEditable","hasEditableTarget","hasRange","anchor","hasPath","hasSelectableTarget","isTargetInsideNonReadonlyVoid","hasTarget","insertData","data","insertFragmentData","insertTextData","isComposing","isFocused","isReadOnly","slateNode","setFragmentData","originEvent","KEY_TO_ELEMENT","toDOMPoint","void","at","selector","texts","querySelectorAll","attr","trueLength","end","nextText","hasAttribute","_nextText$textContent","domText","startsWith","Math","min","max","isBackward","domAnchor","domFocus","isCollapsed","startNode","startOffset","endNode","endOffset","startEl","isStartAtZeroWidth","endEl","isEndAtZeroWidth","domEl","toSlatePoint","searchDirection","nearestNode","nearestOffset","textNode","_domNode$textContent","_domNode$textContent2","potentialVoidNode","voidNode","potentialNonEditableNode","nonEditableNode","leafNode","contents","cloneContents","removals","slice","call","forEach","textContext","removeChild","leafNodes","current","getLeafNodes","elementNode","_leafNodes$find","nextElementSibling","leaf","_leafNodes2$findLast","previousElementSibling","findLast","endsWith","querySelector","_focusNode$textConten","startContainer","anchorOffset","focusNode","focusOffset","firstRange","getRangeAt","lastRange","HTMLTableRowElement","getLastChildren","element","childElementCount","children","firstNodeRow","lastNodeRow","firstNode","lastNode","HTMLElement","innerHTML","endContainer","collapsed","focusBeforeAnchor","isExpanded","isForward","mode","unhangRange","voids","verifyDiffState","textDiff","diff","isText","nextPath","Path","next","nextNode","applyStringDiff","_len","diffs","_key","reduce","longestCommonPrefixLength","str","another","charAt","longestCommonSuffixLength","normalizeStringDiff","targetText","removedText","prefixLength","suffixLength","normalized","mergeStringDiffs","a","b","overlap","applied","sliceEnd","targetRange","normalizePoint","parentBlock","above","isBlock","entry","isDescendant","normalizeRange","transformPendingPoint","op","pendingDiffs","equals","Point","transform","affinity","transformed","type","transformPendingRange","transformTextDiff","newPath","doRectsIntersect","compareRect","middle","bottom","areRangesSameLine","range1","range2","rect1","rect2","findCurrentLineRange","parentRange","parentRangeBoundary","positions","right","floor","withDOM","clipboardFormatKey","e","apply","onChange","deleteBackward","addMark","removeMark","_EDITOR_TO_PENDING_DI","delete","_EDITOR_TO_PENDING_DI2","unit","parentBlockEntry","parentBlockPath","parentElementRange","currentLineRange","pathRefMatches","map","filter","pendingSelection","pendingAction","isPoint","_objectSpread","push","getMatches","_EDITOR_TO_USER_SELEC","unref","prevPath","previous","commonPath","common","changedPath","changedNode","changedNodeKey","changedPathRef","pathRef","edges","startVoid","endVoid","attach","trim","r","cloneRange","setEndAfter","zw","isNewline","span","style","whiteSpace","appendChild","getFragment","string","JSON","encoded","btoa","encodeURIComponent","setAttribute","setData","div","body","decoded","decodeURIComponent","atob","parsed","parse","insertFragment","lines","split","line","splitNodes","always","insertText","onContextChange","p","levels","TRIPLE_CLICK","HOTKEYS","bold","compose","moveBackward","moveForward","moveWordBackward","moveWordForward","deleteForward","extendBackward","extendForward","italic","insertSoftBreak","splitBlock","undo","APPLE_HOTKEYS","moveLineBackward","moveLineForward","deleteLineBackward","deleteLineForward","deleteWordBackward","deleteWordForward","extendLineBackward","extendLineForward","redo","transposeCharacter","WINDOWS_HOTKEYS","create","generic","apple","windows","isGeneric","isHotkey","isApple","isWindows","isBold","isCompose","isMoveBackward","isMoveForward","isDeleteBackward","isDeleteForward","isDeleteLineBackward","isDeleteLineForward","isDeleteWordBackward","isDeleteWordForward","isExtendBackward","isExtendForward","isExtendLineBackward","isExtendLineForward","isItalic","isMoveLineBackward","isMoveLineForward","isMoveWordBackward","isMoveWordForward","isRedo","isSoftBreak","isSplitBlock","isTransposeCharacter","isUndo","objectWithoutPropertiesLoose","shallowCompare","obj1","obj2","Object","keys","every","hasOwnProperty","isDecorationFlagsEqual","other","rangeOwnProps","_objectWithoutProperties","_excluded","otherOwnProps","_excluded2","isElementDecorationsEqual","list","isTextDecorationsEqual","splitDecorationsByChild","decorations","decorationsByChild","level","ancestorRange","cachedChildRanges","getChildRange","cachedRange","childRange","decoration","decorationRange","intersection","startPoint","endPoint","startIndex","endIndex","ds","childDecorationRange"],"mappings":"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","x_google_ignoreList":[2,3,4,5,14,15]}